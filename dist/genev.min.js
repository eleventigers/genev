"use strict";(function(t,n){"undefined"!=typeof exports?n(t,exports,require("underscore")):"function"==typeof define&&define.amd?define(["underscore","exports"],function(i,s){t.Genev=n(t,s,i)}):t.Genev=n(t,{},t._)})(this,function(t,n,i){n.VERSION="0.0.1";var s={gaussRandom:function(){var t,n,i;do t=2*Math.random()-1,n=2*Math.random()-1,i=t*t+n*n;while(i>=1||0===i);var s=Math.sqrt(-2*Math.log(i)/i);return t*s},limit:function(t,n,i){return n>t?n:t>i?i:t},ringify:function(t){return t>1?t-1:0>t?1+t:t},probFn:function(t,n,i,s){var e,r=Array.prototype.slice.call(arguments),n=n||0;return r.length>4&&(e=r.slice(4),e.unshift(t)),n>Math.random()?e?i.apply(null,e):i(t):e?s.apply(null,e):s(t)},parseBoolean:function(t){return"true"===t?!0:!1},populateArray:function(t,n){return i.map(new Float32Array(t),function(){return n instanceof Array?new Float32Array(n):n})},generateMatrix:function(t,n,i){return this.populateArray(t,this.populateArray(n,i))},probab:function(t,n){return n=n||Math.random,t>n()},toType:function(t){return{}.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},rgbToHsb:function(t,n,i){var s,e,r,o,h,a,u,d,p=[];return o=t>n?t:n,i>o&&(o=i),h=n>t?t:n,h>i&&(h=i),r=o/255,e=0!==o?(o-h)/o:0,0===e?s=0:(a=(o-t)/(o-h),u=(o-n)/(o-h),d=(o-i)/(o-h),s=t===o?d-u:n===o?2+a-d:4+u-a,s/=6,0>s&&(s+=1)),p[0]=s,p[1]=e,p[2]=r,p},hsvToRgb:function(t,n,i){var s,e,r,o,h,a,u,d;if(0===n)return s=e=r=i,[Math.round(255*s),Math.round(255*e),Math.round(255*r)];switch(t*=6,o=Math.floor(t),h=t-o,a=i*(1-n),u=i*(1-n*h),d=i*(1-n*(1-h)),o){case 0:s=i,e=d,r=a;break;case 1:s=u,e=i,r=a;break;case 2:s=a,e=i,r=d;break;case 3:s=a,e=u,r=i;break;case 4:s=d,e=a,r=i;break;default:s=i,e=a,r=u}return[Math.round(255*s),Math.round(255*e),Math.round(255*r)]}},e=function(){},r={useColor:!0,useSaturation:!0,width:100,height:100,maxAgents:10,minAgents:3,wrapAround:!0},o=n.Individual=function(t){var n,e,o=Array.prototype.slice.call(arguments);if(this.options=r,"object"===s.toType(t)&&i.extend(this.options,t),"string"==typeof o[0]){e=o[1]||{},n=o[0].split("::"),this.numAgents=parseInt(n[0]),this.width=e.width||parseInt(n[1]),this.height=e.height||parseInt(n[2]),this.wrapAround=s.parseBoolean(n[3]),this.startH=parseFloat(n[4]),this.startS=parseFloat(n[5]),this.startB=parseFloat(n[6]),this.agents=[];for(var h=0;this.numAgents>h;++h)this.agents[h]=new a(n[7+h],i.extend(i.clone(e),i.omit(this.options,"agents"))).setIndex(h)}else this.width=this.options.width,this.height=this.options.height,this.wrapAround=this.options.wrapAround,this.startH=this.options.startH||Math.random(),this.startS=this.options.startS||Math.random(),this.startB=this.options.startB||Math.random(),this.numAgents=this.options.numAgents||Math.round(Math.random()*(this.options.maxAgents-this.options.minAgents)+this.options.minAgents),this.agents=this.options.agents||this.generateAgents(this.numAgents,this.options);return this.maxTime=2*this.width*this.height,this.time=0,this.developed=!1,this.h=s.generateMatrix(this.width,this.height,this.startH),this.s=s.generateMatrix(this.width,this.height,this.startS),this.b=s.generateMatrix(this.width,this.height,this.startB),this.initialize.apply(this,arguments),this};i.extend(o.prototype,{initialize:e,generateAgents:function(t,n){return i.map(i.range(t),function(t,s){return new a(i.extend({index:s},i.omit(n,"agents")))})},step:function(t){var n,s,t=t||1;if(this.developed)return this;for(var e=0;t>e;++e)++this.time,i.each(this.agents,function(t){n=t.step(this,this.time),n&&(s=n.currPos(),this.h[s.x][s.y]=n.h,this.s[s.x][s.y]=n.s,this.b[s.x][s.y]=n.b,n.nextPos())},this);return this.time>=this.maxTime&&(this.developed=!0),this},clone:function(){var t=i.map(this.agents,function(t,n,i){return i[n].clone().setIndex(n)},this);return new o(i.extend(i.clone(this.options),{width:this.width,height:this.height,wrapAround:this.wrapAround,numAgents:this.numAgents,startH:this.startH,startS:this.startS,startB:this.startB,agents:t}))},mutate:function(t){var n,e,h=this.numAgents,u=[],d=this.wrapAround,p=i.map([this.startH,this.startS,this.startB],function(n,i,e){return s.probab(t)?s.ringify(e[i]+s.gaussRandom()):e[i]});return s.probab(2*t)&&this.numAgents<r.maxAgents-1?(++h,u=i.map(i.range(h-1),function(t,n){return this.agents[n].clone().setIndex(n)},this),n=h-1,s.probab(.75)?u[n]=new a(i.extend(i.omit(this.options,"agents"),{index:n})):(e=Math.floor(Math.random()*n),u[h-1]=this.agents[e].clone().setIndex(n))):s.probab(2*t)&&this.numAgents>r.minAgents?(--h,u=i.map(i.range(h),function(t,n){return this.agents[n].clone().setIndex(n)},this),e=Math.floor(Math.random()*h),u[e]=this.agents[h].clone().setIndex(e)):u=i.map(i.range(h),function(t,n){return this.agents[n].clone().setIndex(n)},this),new o(i.extend(i.clone(this.options),{width:this.width,height:this.height,wrapAround:d,numAgents:h,startH:p[0],startS:p[1],startB:p[2],agents:u}))},crossover:function(t){var n,e,r=s.probab(.5)?t.numAgents:this.numAgents,h=s.probab(.5)?t.wrapAround:this.wrapAround,a=s.probab(.5)?t.startH:this.startH,u=s.probab(.5)?t.startS:this.startS,d=s.probab(.5)?t.startB:this.startB;return n=i.map(i.range(r),function(n,i){return s.probab(.33)?this.agents[Math.floor(Math.random()*this.numAgents)].clone().setIndex(i):s.probab(.5)?(e=t.agents[Math.floor(Math.random()*t.numAgents)],this.agents[Math.floor(Math.random()*this.numAgents)].crossover(e).setIndex(i)):this.agents[Math.floor(Math.random()*this.numAgents)].clone().setIndex(i)},this),new o(i.extend(i.clone(this.options),{width:this.width,height:this.height,wrapAround:h,numAgents:r,startH:a,startS:u,startB:d,agents:n}))},toGenomeString:function(){for(var t=this.numAgents+"::"+this.width+"::"+this.height+"::"+this.wrapAround+"::"+this.startH+"::"+this.startS+"::"+this.startB+"::",n=0;this.numAgents>n;++n)t+=this.agents[n].toGenomeString()+"::";return t},fromRGBA:function(t){for(var n,i,e,r,o,h,a=this.width,u=this.height,d=t,p=0,m=0,g=0,c=0;u>c;++c){n=a*c;for(var l=0;a>l;++l)e=d[4*(n+l)],r=d[4*(n+l)+1],o=d[4*(n+l)+2],h=d[4*(n+l)+3],i=s.rgbToHsb(e,r,o),this.h[l][c]=i[0],this.s[l][c]=i[1],this.b[l][c]=i[2],p+=i[0],m+=i[1],g+=i[2]}return this.startH=p/(a*u),this.startS=m/(a*u),this.startB=g/(a*u),this},getRGBA:function(){for(var t,n,i=this.width,e=this.height,r=this.h,o=this.s,h=this.b,a=new Uint8ClampedArray(4*i*e),u=0;e>u;++u){t=i*u;for(var d=0;i>d;++d)n=s.hsvToRgb(r[d][u],o[d][u],h[d][u]),a[4*(t+d)]=n[0],a[4*(t+d)+1]=n[1],a[4*(t+d)+2]=n[2],a[4*(t+d)+3]=255}return a}});var h={x:0,y:0,dir:0,delay:0,delayInt:0,stop:1,stopInt:99999999,gen:0,genTime1:0,genTime2:0,wrapAround:!0,index:1},a=n.Agent=function(t){var n,s,t=t||{},e=Array.prototype.slice.call(arguments);return this.genome=new m,i.extend(this,h),i.extend(this,this._randomizedAttributes()),(1===e.length||2===e.length)&&(s=e[1]||{},"string"==typeof e[0]?(i.extend(this,s),n=e[0].split("#"),this.dir=parseInt(n[0]),this.gen=parseFloat(n[1]),this.genTime1=parseFloat(n[2]),this.genTime2=parseFloat(n[3]),this.delay=parseFloat(n[4]),this.stop=parseFloat(n[5]),this.width=parseInt(n[6]),this.height=parseInt(n[7]),this.genome=new m(n[8],s)):(this.genome=new m(t),i.extend(this,s,t),i.extend(this,this._randomizedGridIndex()))),this._originalAttributes=i.clone(this),this.initialize.apply(this,arguments),this};i.extend(a.prototype,{initialize:e,setIndex:function(t){return this.index=t,i.extend(this,this._randomizedAttributes()),this},mutate:function(t){var n,i=t>Math.random()?Math.floor(9*Math.random()):this._originalAttributes.dir,e=t>Math.random()?s.ringify(this.gen+.2*s.gaussRandom()):this.gen,r=t>Math.random()?s.ringify(this.genTime1+.2*s.gaussRandom()):this.genTime1,o=t>Math.random()?s.ringify(this.genTime2+.2*s.gaussRandom()):this.genTime2,h=t>Math.random()?s.ringify(this.delay+.1*s.gaussRandom()):this.delay,u=t>Math.random()?s.ringify(this.stop+.1*s.gaussRandom()):this.stop;return h>u&&(n=h,h=u,u=n),new a({x:this.x,y:this.y,width:this.width,height:this.height,wrapAround:this.wrapAround,maxAgents:this.maxAgents,genome:this.genome.mutate(t),dir:i,gen:e,genTime1:r,genTime2:o,delay:h,stop:u})},crossover:function(t){var n=.5,i=n>Math.random()?t.gen:this.gen,s=n>Math.random()?t.genTime1:this.genTime1,e=n>Math.random()?t.genTime2:this.genTime2,r=n>Math.random()?t.delay:this.delay,o=n>Math.random()?t.stop:this.stop;return new a({x:this.x,y:this.y,width:this.width,height:this.height,wrapAround:this.wrapAround,maxAgents:this.maxAgents,genome:this.genome.crossover(t.genome),dir:this._originalAttributes.dir,gen:i,genTime1:s,genTime2:e,delay:r,stop:o})},clone:function(){return new a({x:this.x,y:this.y,width:this.width,height:this.height,wrapAround:this.wrapAround,maxAgents:this.maxAgents,dir:this._originalAttributes.dir,gen:this.gen,genTime1:this.genTime1,genTime2:this.genTime2,delay:this.delay,stop:this.stop,genome:this.genome.clone()})},step:function(t,n){if(!(this.delayInt>n||n>this.stopInt)){var s=this._collectInputs(t,n),e=this.genome.evaluate(s),r=this._getNextPosition(this._floatToDir(e[3])),o={nextPos:i.partial(i.bind(function(t){return this.x=t.x,this.y=t.y,t},this),r),currPos:i.partial(function(t){return{x:t.x,y:t.y}},this),h:e[0],s:e[1],b:e[2]};return o}},_collectInputs:function(t,n){for(var i,s,e,r,o,h,a,u,d,p,m,g,c=0,l=0,f=1,y=0,A=0,b=1e3*this.genTime1,b=1>b?1:b,x=1e3*this.genTime2,x=1>x?1:x,w=n%b/b,M=n%x/x,v=-1,T=-1,I=-1,N=-1,_=0,F=0,S=Math.random(),B=t.b[this.x][this.y],H=t.s[this.x][this.y],R=t.h[this.x][this.y],P=this._inverseDirection(this.dir),D=this._dirToFloat(P),k=this._getNextPosition(P),G=t.b[k.x][k.y],z=t.s[k.x][k.y],U=t.h[k.x][k.y],C=0,j=0,q=-1,E=0,L=Array(9),V=0;9>V;++V)i=this._getNextPosition(V),s=t.h[i.x][i.y],e=t.s[i.x][i.y],r=t.b[i.x][i.y],A+=s,y+=e,c+=r,o=Math.pow(s-B,2)+Math.pow(e-H,2)+Math.pow(r-B,2),o>q&&(q=o,E=V),r>l&&(l=r,C=V),f>r&&(f=r,j=V);c/=9,y/=9,A/=9,h=this._dirToFloat(C),a=this._dirToFloat(j),u=this._dirToFloat(E);for(var V=0;8>V;++V)i=this._getNextPosition(V),r=t.b[i.x][i.y],r>=c&&(L[V]=!0);for(var V=0;8>V;++V)d=Math.random(),p=Math.random(),m=V-1,m=1>m?7:m,g=V+1,g=g>=8?1:g,L[V]?((0>I||.3>d)&&(I=this._dirToFloat(V)),0!==L[m]&&0!==L[g]||!(0>T||.3>p)||(T=this._dirToFloat(V),F=T)):((0>N||.3>d)&&(N=this._dirToFloat(V)),0===L[m]&&0===L[g]||!(0>v||.3>p)||(v=this._dirToFloat(V),_=v));return I=0>I?this.gen:I,N=0>N?this.gen:N,v=0>v?this.gen:v,T=0>T?this.gen:T,[S,B,c,l,f,a,G,H,y,z,R,A,U,D,u,I,N,this.gen,w,M,v,T,t.startH,t.startS,t.startB,_,F]},toGenomeString:function(){var t=this._originalAttributes.dir+"#"+this.gen+"#"+this.genTime1+"#"+this.genTime2+"#"+this.delay+"#"+this.stop+"#"+this.width+"#"+this.height+"#"+this.genome.toGenomeString()+"#";return t},_randomizedAttributes:function(t){t=t||Math.random();var n=Math.floor(9*Math.random()),i=Math.random(),s=Math.random(),e=Math.random(),r=.33>Math.random()?0:.33*Math.random(),o=.33>Math.random()?1:.66*Math.random()+.33;return.2>t?(r=0,o=.5*Math.random()):.4>t&&(r=.4000000059604645*Math.random()+.3,o=1),{dir:n,gen:i,genTime1:s,genTime2:e,delay:r,stop:o}},_randomizedGridIndex:function(){var t=2*this.width*this.height,n=Math.round(t*this.delay),i=Math.round(t*this.stop),s=Math.sqrt(this.maxAgents),e=this.index/s*(this.width/s)+.1*this.width,r=this.index%s*(this.height/s)+.1*this.height,e=e>=this.width?this.width-.2*this.width:e,r=r>=this.height?this.height-.2*this.height:r,o=Math.floor(e),h=Math.floor(r);return{delayInt:n,stopInt:i,x:o,y:h}},_getNextPosition:function(t){var n=[this.x,this.y],i=this.wrapAround,s=this.width,e=this.height;switch(t){case 1:n[0]-=1;break;case 2:n[0]-=1,n[1]-=1;break;case 3:n[1]-=1;break;case 4:n[0]+=1,n[1]-=1;break;case 5:n[0]+=1;break;case 6:n[0]+=1,n[1]+=1;break;case 7:n[1]+=1;break;case 8:n[0]-=1,n[1]+=1}return n[0]=0>n[0]?i?s-1:0:n[0],n[0]=n[0]>=s?i?0:s-1:n[0],n[1]=0>n[1]?i?e-1:0:n[1],n[1]=n[1]>=e?i?0:e-1:n[1],{x:n[0],y:n[1]}},_inverseDirection:function(t){var n;return 0===t?0:(n=(t+4)%8,0===n&&(n=8),n)},_dirToFloat:function(t){return t/9},_floatToDir:function(t){return parseInt(9*t)}});var u=["inputsH","inputsS","inputsB","inputsDir","nodesH","nodesS","nodesB","nodesDir","constArr"],d={add:function(t,n){return t+n},sub:function(t,n){return t-n},mult:function(t,n){return t*n},ind:function(t,n,i){return this.constArr[i]},min:function(t,n){return n>t?t:n},max:function(t,n){return t>n?t:n},sin:function(t){return Math.sin(t)},atan:function(t){return Math.atan(t)},id:function(t){return t},mean:function(t,n){return t+n/2},realmean:function(t,n){return(t+n)/2},div:function(t,n){return Number.MIN_VALUE>n?t:Math.round(t/n)},incdec:function(t,n){return n>.5?t+.125:t-.125},inv:function(t){return 1-t}},p={agentTreeDepth:3,agentInputs:27,biasHTree:!1,biasSTree:!1,biasBTree:!1,biasNoChange:!1},m=n.Genome=function(){var t,n,e,r=Array.prototype.slice.apply(arguments),o=[];if(this.options={},"array"===s.toType(r[0])?(o=r[0],t=r[1]||{}):"string"==typeof r[0]?(n=r[0].split("!"),t=r[1]||{}):"object"===s.toType(r[0])&&(t=r[0]),i.extend(this.options,p,t),this.numTotalNodes=Math.floor(Math.pow(2,this.options.agentTreeDepth+1)-1),this.numInputNodes=Math.floor(Math.pow(2,this.options.agentTreeDepth)),this.numProcessNodes=this.numTotalNodes-this.numInputNodes,this.inputsH=new Uint8Array(i.invoke(i.range(this.numInputNodes),i.bind(this._getRandomInput,this),this.options.biasNoChange,0,!0)),this.inputsS=new Uint8Array(i.invoke(i.range(this.numInputNodes),i.bind(this._getRandomInput,this),this.options.biasNoChange,1,!0)),this.inputsB=new Uint8Array(i.invoke(i.range(this.numInputNodes),i.bind(this._getRandomInput,this),this.options.biasNoChange,2,!0)),this.inputsDir=new Uint8Array(i.invoke(i.range(this.numInputNodes),i.bind(this._getRandomInput,this),!1,0,!0)),this.nodesH=i.invoke(i.range(this.numProcessNodes),this._getRandomFunction,this.options.biasNoChange),this.nodesS=i.invoke(i.range(this.numProcessNodes),this._getRandomFunction,this.options.biasNoChange),this.nodesB=i.invoke(i.range(this.numProcessNodes),this._getRandomFunction,this.options.biasNoChange),this.nodesDir=i.invoke(i.range(this.numProcessNodes),this._getRandomFunction,!1),this.constArr=new Float32Array(i.map(i.range(this.numProcessNodes),Math.random)),(this.options.biasHTree||this.options.biasSTree||this.options.biasBTree)&&(this.constArr[0]=.4*Math.random()+.3),this.options.biasSTree&&(this.nodesS[0]="ind"),this.options.biasBTree&&(this.nodesB[0]="ind"),n&&n.length>0){this.numInputNodes=parseInt(n[0]),this.numProcessNodes=parseInt(n[1]),this.numTotalNodes=this.numInputNodes+this.numProcessNodes,n=n.splice(2),e=0;for(var h=0;this.numInputNodes>h;++h)this.inputsH[h]=parseInt(n[e]),this.inputsS[h]=parseInt(n[e+1]),this.inputsB[h]=parseInt(n[e+2]),this.inputsDir[h]=parseInt(n[e+3]),e+=4;for(var h=0;this.numProcessNodes>h;++h)this.nodesH[h]=n[e],this.nodesS[h]=n[e+1],this.nodesB[h]=n[e+2],this.nodesDir[h]=n[e+3],this.constArr[h]=parseFloat(n[e+4]),e+=5}for(var h=0;o.length>h;++h)(o[h]instanceof Array||o[h]instanceof Uint8Array||o[h]instanceof Float32Array)&&(this[u[h]]=o[h]);this.initialize.apply(this,arguments)};i.extend(m.prototype,{initialize:e,clone:function(){return new m([new Uint8Array(this.inputsH),new Uint8Array(this.inputsS),new Uint8Array(this.inputsB),new Uint8Array(this.inputsDir),this.nodesH.slice(0),this.nodesS.slice(0),this.nodesB.slice(0),this.nodesDir.slice(0),new Float32Array(this.constArr)],this.options)},mutate:function(t){var n=this.clone();return n.inputsH=i.map(n.inputsH,function(n){return s.probFn(n,t,this._getRandomInput,d.id,!1,0,!1)}),n.inputsS=i.map(n.inputsS,function(n){return s.probFn(n,t,this._getRandomInput,d.id,!1,1,!1)}),n.inputsB=i.map(n.inputsB,function(n){return s.probFn(n,t,this._getRandomInput,d.id,!1,2,!1)}),n.inputsDir=i.map(n.inputsDir,function(n){return s.probFn(n,t,this._getRandomInput,d.id,!1,0,!1)}),n.nodesH=i.map(n.nodesH,function(n){return s.probFn(n,t,this._getRandomFunction,d.id,!1)}),n.nodesS=i.map(n.nodesS,function(n){return s.probFn(n,t,this._getRandomFunction,d.id,!1)}),n.nodesB=i.map(n.nodesB,function(n){return s.probFn(n,t,this._getRandomFunction,d.id,!1)}),n.nodesDir=i.map(n.nodesDir,function(n){return s.probFn(n,t,function(){return Math.floor(Math.random()*d.length)},d.id)}),n.constArr=i.map(n.constArr,function(n){return s.probFn(n,t,function(t){return s.limit(t+.2*s.gaussRandom())},d.id)}),n},crossover:function(t){if(t instanceof m){var n,s=.5,e=i.pick(this.numProcessNodes>t.numProcessNodes?this:t,"inputsH","inputsS","inputsB","inputsDir","nodesH","nodesS","nodesB","nodesDir","constArr"),r=i.map(e,function(e,r){return n=i.map(e,function(n,i){return s>Math.random()?t[r][i]||n:n||t[r][i]})}),o={};return i.each(e.options,function(t,n){o[n]=t}),new m(r,o)}throw new TypeError("Genev.js: to crossover a genome, another genome must be provided!")},evaluate:function(t){for(var n,i,e=new Float32Array(this.numTotalNodes),r=new Float32Array(this.numTotalNodes),o=new Float32Array(this.numTotalNodes),h=new Float32Array(this.numTotalNodes),a=this.numProcessNodes;this.numTotalNodes-1>a;a++)e[a]=t[this.inputsH[a-this.numProcessNodes]]||0,r[a]=t[this.inputsS[a-this.numProcessNodes]]||0,o[a]=t[this.inputsB[a-this.numProcessNodes]]||0,h[a]=t[this.inputsDir[a-this.numProcessNodes]]||0;for(var a=this.numProcessNodes-1;a>=0;a--)n=2*a+1,i=2*a+2,e[a]=s.ringify(d[this.nodesH[a]].apply(this,[e[n],e[i],a])),r[a]=s.ringify(d[this.nodesS[a]].apply(this,[r[n],r[i],a])),o[a]=s.ringify(d[this.nodesB[a]].apply(this,[o[n],o[i],a])),h[a]=s.ringify(d[this.nodesDir[a]].apply(this,[h[n],h[i],a]));return[e[0],r[0],o[0],h[0]]},toGenomeString:function(){for(var t=this.numInputNodes+"!"+this.numProcessNodes+"!",n=0;this.numInputNodes>n;++n)t+=this.inputsH[n]+"!",t+=this.inputsS[n]+"!",t+=this.inputsB[n]+"!",t+=this.inputsDir[n]+"!";for(var n=0;this.numProcessNodes>n;++n)t+=this.nodesH[n]+"!",t+=this.nodesS[n]+"!",t+=this.nodesB[n]+"!",t+=this.nodesDir[n]+"!",t+=this.constArr[n]+"!";return t},_getRandomInput:function(t,n,i){var s=Math.random();return t?0===n?.33>s?11:.66>s?12:13:1===n?.33>s?8:.66>s?9:10:.2>s?1:.4>s?2:.6>s?3:.8>s?5:7:i?Math.floor(Math.random()*(this.options.agentInputs-1)+1):Math.random()*this.options.agentInputs},_getRandomFunction:function(t){var n=Math.random();return t?.01>n?"add":.02>n?"sub":.03>n?"mult":.04>n?"ind":.05>n?"max":.06>n?"min":.8>n?"div":.85>n?"id":.88>n?"realmean":.9>n?"atan":.98>n?"incdec":.99>n?"sin":"inv":.05>n?"add":.1>n?"sub":.15>n?"mult":.25>n?"ind":.3>n?"max":.35>n?"min":.5>n?"atan":.6>n?"id":.82>n?"realmean":.85>n?"div":.95>n?"incdec":.98>n?"sin":"inv"}});var g=function(t,n){var s,e=this;s=t&&i.has(t,"constructor")?t.constructor:function(){return e.apply(this,arguments)},i.extend(s,e,n);var r=function(){this.constructor=s};return r.prototype=e.prototype,s.prototype=new r,t&&i.extend(s.prototype,t),s.__super__=e.prototype,s};return o.extend=a.extend=m.extend=g,n});